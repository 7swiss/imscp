# DOVECOT(1) configuration file - auto-generated by i-MSCP
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN

# Mail location

mail_location = maildir:~/

# Namespaces

namespace inbox {
    separator = .
    prefix = INBOX.
    inbox = yes
    type = private

    mailbox Drafts {
        special_use = \Drafts
        auto=subscribe
    }

    mailbox Junk {
        special_use = \Junk
        auto=subscribe
    }

    mailbox Sent {
        special_use = \Sent
        auto=subscribe
    }

    mailbox Trash {
        special_use = \Trash
        auto=subscribe
    }
}

# Plugins

mail_plugins = quota

plugin {
    quota = maildir:User quota
    quota_rule = *:storage=1G
    quota_rule2 = INBOX.Trash:storage=+100M
    quota_warning = storage=95%% quota-warning 95 %u
    quota_warning2 = storage=80%% quota-warning 80 %u
}

# Password databases

passdb {
    args = {PO_CONF_DIR}/dovecot-sql.conf
    driver = sql
}

# User databases

userdb {
    driver = prefetch
}

userdb {
    args = {PO_CONF_DIR}/dovecot-sql.conf
    driver = sql
}

# Authentication

auth_mechanisms = plain login
disable_plaintext_auth = no

service auth {
    unix_listener auth-master {
        mode = 0600
        user = {MTA_MAILBOX_UID_NAME}
    }

    unix_listener {PO_SASL_AUTH_SOCKET_PATH} {
        mode = 0660
        user = {MTA_USER}
        group = {MTA_GROUP}
    }
    
    unix_listener auth-userdb {
        mode = 0600
        user = {MTA_MAILBOX_UID_NAME}
    }
}

# Quota

service quota-warning {
    executable = script {BACKEND_ROOT_DIR}/quota/imscp-dovecot-quota.sh
    group = {IMSCP_GROUP}

    unix_listener quota-warning {
        mode = 0600
        user = {MTA_MAILBOX_UID_NAME}
    }
}

# Interfaces to listen on
listen = {PO_LISTEN_INTERFACES}

!include_try /usr/share/dovecot/protocols.d/*.protocol

# Including override files (they must be included before any filter
# that make use of global setting
!include_try /etc/dovecot/imscp.d/*.conf

# IMAP

protocol imap {
    mail_plugins = $mail_plugins imap_quota
}

# POP3

pop3_uidl_format = %u-%v
pop3_logout_format = top=%t/%p, retr=%r/%b, del=%d/%m, size=%s, in=%i, out=%o 

# LDA

postmaster_address = postmaster@{SERVER_HOSTNAME}
