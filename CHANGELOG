i-MSCP ChangeLog

------------------------------------------------------------------------------------------------------------------------
Git 1.3.x
------------------------------------------------------------------------------------------------------------------------

BACKEND
    Added: beforeMountLogsFolder, afterMountLogsFolder, beforeUnmountLogsFolder and afterUmountMountLogsFolder events
    Added: Caller info for __DIE__ and __WARN__ signal handlers
    Added: Debug info for loading of listener files (Event::Manager)
    Added: 'fixpermissions' option for the iMSCP::Dir::make() method
    Added: iMSCP::Database::mysql::useDatabase() method - Allow to select database on which we want operate on
    Added: i-MSCP (imscp) master system user (homedir is /var/local/imscp)
    Added: iMSCP::OpenSSL::getCertificateExpiryTime() method - Allow to get SSL certificate expiry time (UNIX timestamp)
    Added: onBoot event in iMSCP::Bootstrapper (triggered at end of bootstrapping process)
    Added: Support for PHP 7 (httpd servers implementations)
    Added: Support for prime256v1 (ECDSA) keys (iMSCP::OpenSSL)
    Added: Support for systemd socket units (systemd init provider)
    Backported: iMSCP::DbTasksProcessor from 1.3.x branch - Allows to process db tasks without spawning new process
    Backported: imscp-mountall-mngr (as imscp-mountall) from 1.3.x branch - Mount i-MSCP file systems on server reboot
    Backported: iMSCP::Mount library from 1.3.x branch - Library for mounting/unmounting file systems
    Changed: Upstart job file paths, sysvinit script paths and systemd unit files paths are now cached (init providers)
    Fixed: composer.phar must not be run with root user privileges (it is now run with i-MSCP system master user)
    Fixed: Could not disable custom DNS resource records; DNS resource records are always re-enabled on domain change
    Fixed: eth0 is hardcoded in i-MSCP network interface provider
    Fixed: Ignore user-specific options if any (~/.my.cnf file) when running mysqldump (iMSCP::Database::mysql::dumpdb)
    Fixed: Many inconsistencies in iMSCP::Getopt
    Improvement: Allow registering listeners on many events at once (Event::Manager)
    Introduced: HSTS (HTTP Strict Transport Security) feature
    Removed: beforeDispatchRequest and afterDispatchRequest events
    Removed: cache data directory (/var/cache/imscp directory)
    Removed: imscp-httpd-logs-mngr script (Apache2 logs dirctories are now mounted via the imscp_mountall service)
    Removed: installConfFile() method from httpd server packages
    Rewritten: iMSCP::SetRights library (usage of built-in functions to avoid call of system chown/chmod commands)

CONFIG
    Added: php configuration directory (directory which holds all PHP template and configuration parameters)
    Added: DISTRO_ID, DISTRO_CODENAME and DISTRO_RELEASE parameters in imscp.conf file
    Added: IMSCP_USER parameter (name of i-MSCP master system user)
    Added: IPV6_SUPPORT parameter (tells whether or not IPv6 support is enabled for the server)
    Added: MAX_INSTANCES, MAX_CLIENT_PER_HOST and FTPD_CONF_DIR parameters in proftpd/proftpd.data file
    Added: MOUNT_CUSTOMER_LOGS parameter in apache/apache.data file (allows to disable logs bind mounts)
    Changed: Increased default limits for ProFTPD/VsFTPd
    Changed: Moved DirectoryIndex directive in vhosts (Apache2)
    Depreciated: CACHE_DATA_DIR (/var/cache/imscp) parameter
    Fixed: Allow access to .well-known folder in any case if exists (Apache2)
    Moved: nginx configuration directory to frontend configuration directory
    Removed: Redundant MYSQL_PREFIX_TYPE parameter
    Removed: VARIABLE_DATA_DIR parameter
    Removed: i-MSCP intermediate working files, including working directory (Postfix)
    Removed: i-MSCP intermediate working files, including working directory (Apache)
    Removed: fcgi configuration directory (merged into php configuration directory)
    Removed: php-fpm configuration directory (merged into php configuration directory)

CONTRIB
    Added: 10_bind9_rrl listener file (Listener implementing RRL (Response-Rate-Limiting))
    Added: PhpMyAdmin/10_phpmyadmin_conffile.pl listener file (Allows to override default configuration template file)

DAEMON
    Added: notify() function allowing to notify parent process when daemon has been fully initialized
    Added: Added help for command line options
    Bumped: Version to 1.3.0
    Fixed: Ensures that the daemon process is re-parented to init/PID 1 (double fork())
    Fixed: Exits from the parent process only after daemon full initialization
    Fixed: Possible buffer overflow
    Fixed: Segfault when client issue bad `helo` command
    Merged: signal handlers

DATABASE
    Added: SPF type to the list of allowed DNS resource records
    Changed: domain_dns.domain_dns and domain_dns.domain_text column types from varchar to text
    Changed: i-MSCP now uses its own SQL user (master SQL user). See errata file for more details.
    Updated: domain_id index on domain_dns table; added index length for domain_dns and domain_text columns

DISTRO
    Fixed: libpam-mysql - undefined symbol: make_scrambled_password (bugs affecting all distributions)
    Fixed: libpam-mysql - possible segfault (bugs affecting all distributions)

FRONTEND
    Added: Datatable for domains, subdomains, domain aliases and DNS resource records (client level)
    Added: Datatable for the file system information table (admin level)
    Added: iMSCP\Net class - Allow to get list of network devices and IP addresses (stdlib)
    Added: SPF DNS resource record type (validated as a TXT record) (client level)
    Added: Support for .phtml template files (stdlib)
    Added: torul() function for escaping a string for the URI or Parameter contexts (stdlib)
    Backported: Exclamation icon from 1.3.x branch
    Backported: iMSCP\Crypt library from 1.3.x branch (not used by core atm)
    Changed: exec() PHP function is no longer disabled for the control panel (master php.ini file)
    Changed: The `type` field cannot longer be changed when editing a DNS resource record (client level)
    Changed: Support for nested MySQL transactions is now emulated using named transaction savepoints (stdlib)
    Fixed: Cannot add DKIM/DMARC DNS resource records (client level)
    Fixed: Could not retrieve network devices list under Debian Stretch (testing) - Related to #IP-1525 (admin level)
    Fixed: Customer must be allowed to set custom TTL value for any DNS resource record (client level)
    Fixed: Customer must be allowed to set `name` field of any DNS resource record (client level)
    Fixed: Could not remove database; There is no such grant defined for user... (stdlib)
    Fixed: Could not set URL redirect when adding domain alias; Bad request error page (client level)
    Fixed: IDNs are shown in IDNA form in several places
    Fixed: iMSCP_Update_Database::addIndex() doesn't allows to set index length (stdlib)
    Fixed: Uncaught ReferenceError: ajaxStop is not defined (admin level)
    Fixed: Wrong behavior with exception handler when database connection is not available (stdlib)
    Fixed: Privileges on database that contains wildcards are not removed when SQL user is assigned to many databases
    Fixed: Wrong value for LOG_LEVEL configuration parameter
    Introduced: HSTS (HTTP Strict Transport Security) feature
    Removed: User deletion confirmation pages (admin and reseller levels)
    Removed: iMSCP_NetworkCard class; replaced by iMSCP\Net class (stdlib)
    Rewritten: FTP chooser interface to avoid usage of iframe and allows fine-grained filtering (client level)
    Rewritten: Protected area interface (client level)

INSTALLER
    Added: --fix-permissions command line option. See errata file for more details.
    Added: Check for maximum supported PHP/Perl versions
    Added: Check to prevent downgrade attempts (when DB schema change is involved)
    Added: Conditional statement feature for install.xml files (copy_config items only)
    Added: onBuildPackageList event (Allows to override default distribution packages file)
    Fixed: Allows to rebuild any package with privuded set of patches
    Fixed: '_' and '%' wildcards must be escaped in GRANT statements
    Fixed: Debug and verbose modes must be set early
    Fixed: Disable Dovecot systemd socket activation unit if any (not needed for Dovecot as configured by i-MSCP)
    Fixed: Don't die on misconfigured server hostname. Just ask for a valid hostname instead
    Fixed: Invalid regexes for SQL user/password (Package::PhpMyAdmin::Installer)
    Fixed: libmariadbclient18 package not provided in Debian Stretch (testing) repository
    Fixed: /etc/mailname file not updated when reconfiguring system hostname
    Fixed: Ignore SIGNINT to prevent user aborting installer in wrong way
    Fixed: MySQL server 5.6 no longer available for Ubuntu 16.04 (replaced by MySQL server 5.7)
    Fixed: Plugin setup listeners are no longer registered (regression fix)
    Fixed: SQL user and password not correctly escaped in imscp.cnf file (Servers::sqld::mysql::installer)
    Moved: Master administrator questions and setup routines into Package::FrontEnd::Installer
    Removed: Update notices (link to errata file is sufficient)
    Renamed: imscp-setup script to imscp-reconfigure

PACKAGES
    Added: Monsta FTP package
    Fixed: ERR_INCOMPLETE_CHUNKED_ENCODING error due to wrong permissions on nginx fastcgi cache directory (FrontEnd)
    Fixed: White page due to 'net::ERR_INCOMPLETE_CHUNKED_ENCODING' errors (related to #IP-1530) (PhpMyAdmin)
    Updated: PhpMyAdmin version to 4.6.0 - Only for servers with PHP/MySQL >= 5.5 (Package::PhpMyAdmin::Installer)
    Disabled: Pydio in case PHP >= 7.0.0 is detected

PLUGINS
    Enhancement: Plugin backend packages can now be simple objects
    Fixed: Plugin configuration not synced when triggering plugin list update (when a plugin is in error state)
    Fixed: The 'change' action must be automatically triggered on plugin list update, even for plugins with error state
    Fixed: Wrong events triggered when a plugin is being locked/unlocked
    Updated: API version to 1.0.4

SERVERS
    Added: i-MSCP own logrorate configuration file for ProFTPD (xferlog file don't need to be rotated)
    Added: i-MSCP own sysvinit script for ProFTPD - solve #IP-1402
    Changed: setenvif module is now always required ((Httpd servers)
    Fixed: AH01265: attempt to invoke directory as script: /var/www/virtual/<domain.tld>/cgi-bin/
    Fixed: Bad regexp in getTraffic() method leading to unmatching of traffic data (VsFTPd)
    Fixed: Could not build local vsftpd package when gpg has been initialized; .changes file cannot be signed
    Fixed: Courier sysvinit script must not be copied when selected PO server is Dovecot
    Fixed: Disabled mod_tls_memcache.c module to avoid weird notice on restart (ProFTPD)
    Fixed: Don't change user/group and mode when not required (Httpd server implementations)
    Fixed: Do not remove default dns records that are not redefined (Servers::named::bind)
    Fixed: Enable support for UTF-8 file systems (VsFTPd)
    Fixed: Hide real server identity (ProFTPD)
    Fixed: Invalid version format (non-numeric data) when installing VsFTPd on Debian Stretch (testing)
    Fixed: IP addresses are added multiple time in Apache 00_nameserver.conf file (Httpd servers)
    Fixed: libmysqlclient18 package not available for Ubuntu 16.04
    Fixed: maillogconvert.pl must not be installed in /usr/sbin (moved to /usr/local/sbin)
    Fixed: maillogconvert.pl not removed on uninstallation
    Fixed: maillogconvert.pl path must not be hardcoded
    Fixed: ON|OFF strings not recognized as boolean value in imscp.cnf file (MySQL)
    Fixed: Postfix (>= 3.0) is showing many warnings about backwards-compatible settings (default setting chroot=y)
    Fixed: Postfix maps must not be world-readable (Postfix)
    Fixed: Traffic accounting routines must not remove log files (ProFTPD/VsFTPd). Files are now truncated instead
    Fixed: Useless reload of VsFTPd when adding/removing an FTP user (privileges are given by session)
    Fixed: VsFTPd doesn't reopen xferlog file automatically when the file has been removed, leading to traffic data loss
    Fixed: VsFTPD doesn't support non-ascii characters in FTP usernames
    Fixed: When the --skip-distro-packages installer option is set, the vsftpd local package shouldn't be rebuilt
    Removed: /var/log/proftpd/ftp_traff.log custom log. Traffic data are now pulled from /var/log/proftpd/xferlog

VLOGGER
    Fixed: Avoid SELECT queries while dump of traffic data
    Fixed: SQL statement must be prepared once per dump process
    Fixed: Wrong SQL user host (localhost instead of 127.0.0.1)

YOUTRACK
    IP-0931 Unexpected error on protected area creation
    IP-1231 Default SPF DNS resource records should be overrideable
    IP-1365 Check for IPv6 support when installing services
    IP-1395 Domain redirect feature - Missing URL path separator
    IP-1402 ProFTPD doesn't restart properly - killed (signal 15) - Wheezy/Precise/Trusty
    IP-1410 Feature - Possibility to change redirection type
    IP-1509 Could not generate SSL certificate through the frontEnd - Invalide SSL certificate
    IP-1510 VsFTPd - Use of uninitialized value $tmpFile
    IP-1511 Use of uninitialized value $imscpOldConfig{"BASE_SERVER_VHOST"} on fresh install
    IP-1513 Autoreply - Do not autoreply to messages marked as SPAM
    IP-1514 Could not install i-MSCP on Ubuntu Trusty Thar in some contexts
    IP-1525 ifconfig output format has changed in latest versions
    IP-1527 Wrong syntax in the VsFTPd uninstaller, leading to an i-MSCP uninstallation failure
    IP-1530 Nginx - Failed to load resource: net::ERR_INCOMPLETE_CHUNKED_ENCODING
    IP-1533 i-MSCP is not compatible with servers on which IPv6 stack is disabled
    IP-1536 systemd - imscp_daemon service can fail to start/restart
    IP-1539 Default behaviour when adding a MySQL user is counter-intuitive
    IP-1549 RRL implementation for BIND/Named config
    IP-1555 Syntax error in imscp-disable-accounts script
    IP-1557: vsftpd - request failed due to PAM unable to dlopen(pam_mysql.so): /lib/security/pam_mysql.so: undefined
        symbol: make_scrambled_password

------------------------------------------------------------------------------------------------------------------------
Older release series
------------------------------------------------------------------------------------------------------------------------

See ./docs/Changelog-x.x.x files
